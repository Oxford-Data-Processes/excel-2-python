classes:
  - name: ExcelFile
    type: dataclass
    description: "Represents an Excel file"
    attributes:
      - name: file_path
        type: str
      - name: workbook
        type: openpyxl.Workbook

  - name: Worksheet
    type: dataclass
    description: "Represents an Excel worksheet"
    attributes:
      - name: sheet_name
        type: str
      - name: workbook_name
        type: Optional[str]
      - name: worksheet
        type: Optional[openpyxl.Worksheet]

  - name: Cell
    type: dataclass
    description: "Represents an Excel cell"
    attributes:
      - name: column
        type: int
      - name: row
        type: int
      - name: coordinate
        type: str

  - name: CellRange
    type: dataclass
    description: "Represents a range of cells"
    attributes:
      - name: start_cell
        type: Cell
      - name: end_cell
        type: Cell

  - name: HeaderLocation
    type: enum
    description: "Represents the location of the header"
    attributes:
      - name: TOP
        value: "top"
      - name: LEFT
        value: "left"

  - name: Table
    type: dataclass
    description: "Represents a table"
    attributes:
      - name: name
        type: str
      - name: range
        type: CellRange
      - name: header_location
        type: HeaderLocation
      - name: header_values
        type: list[str]

  - name: SeriesDataType
    type: enum
    description: "Represents the data type of a series"
    attributes:
      - name: INT
        value: "int"
      - name: STR
        value: "str"
      - name: FLOAT
        value: "float"
      - name: BOOL
        value: "bool"

  - name: Series
    type: dataclass
    description: "Represents a series"
    attributes:
      - name: series_id
        type: UUID
      - name: worksheet
        type: Worksheet
      - name: series_header
        type: str
      - name: formulas
        type: list[str]
      - name: values
        type: list[Union[int, str, float, bool]]
      - name: header_location
        type: HeaderLocation
      - name: series_starting_cell
        type: Cell
      - name: series_length
        type: int
      - name: series_data_type
        type: SeriesDataType

  - name: SeriesRange
    type: dataclass
    description: "Represents a range of cells for a series"
    attributes:
      - name: series
        type: list[Series]
      - name: start_index
        type: int
      - name: end_index
        type: int

  - name: ASTGenerator
    type: regular
    description: "An object with a get_ast() method that returns the ast of the nth index"
    attributes:
      - name: formula_1_series
        type: xlcalculator.ast_nodes.ASTNode
      - name: formula_2_series
        type: xlcalculator.ast_nodes.ASTNode
    methods:
      - name: get_ast
        type: instance
        inputs:
          - name: index
            type: int
        output:
          - name: ast
            type: xlcalculator.ast_nodes.ASTNode

  - name: ASTGeneratorPython
    type: regular
    description: "An object with a get_ast_python() method but where the ast output has PythonFunction objects instead of FunctionNode objects."
    methods:
      - name: get_ast_python
        type: instance
        inputs:
          - name: index
            type: int
          - name: ast
            type: xlcalculator.ast_nodes.ASTNode
        output:
          - name: ast_python
            type: xlcalculator.ast_nodes.ASTNode

  - name: ExcelLoader
    type: regular
    description: "Loads an Excel file"
    methods:
      - name: load_file
        type: static
        inputs:
          - name: file_path
            type: str
        output:
          - name: excel_file
            type: ExcelFile

  - name: ExcelCompatibilityChecker
    type: regular
    description: "Checks the compatibility of raw and reduced Excel files"
    methods:
      - name: check_file
        type: static
        inputs:
          - name: excel_raw
            type: ExcelFile
          - name: excel_reduced
            type: ExcelFile
          - name: extracted_tables
            type: dict[Worksheet, list[Table]]
        output:
          - name: is_compatible
            type: bool

  - name: ExcelValidator
    type: regular
    description: "Validates an Excel file"
    methods:
      - name: validate_excel
        type: static
        inputs:
          - name: excel_reduced
            type: ExcelFile
        output:
          - name: is_valid
            type: bool

  - name: SeriesExtractor
    type: regular
    description: "Extracts series from an Excel file"
    methods:
      - name: extract_series
        type: static
        inputs:
          - name: excel_reduced_clean
            type: ExcelFile
          - name: extracted_tables
            type: dict[Worksheet, list[Table]]
        output:
          - name: series_data
            type: dict[UUID, list[Series]]
